　# MVP 2.0 追加仕様（ai-vector-ui-generator 拡張計画）
（Codex 追加指示用）

## 0. 目的（MVP 2.0 のゴール）
MVP 1.0（JSON→SVG/PDF/PNG 決定論レンダリング）を土台に、
**「デザイン業務が回る」＝デザイナーが生成・確認・修正指示・差分再生成できる状態**へ強化する。

本ツールは **UIエディタ/Figma代替ではない**。
ピクセル単位の最終調整やエンジン組み込みは範囲外。
MVP 2.0 は **デザイナーとエンジニアの橋渡し**として、
「意味・構造・意図」を安定して伝える中間層を作る。

---

## 1. 想定ユーザーと役割
### デザイナー
- AI にプロンプト依頼し、世界観や意図に合わせた UI を自動生成
- 生成結果を **プレビューで確認し、微調整（意味ベース）**を行う
- OK を出したら、素材＋配置データをエンジニアへ渡す

### エンジニア
- デザイナーが作った UI 素材・配置データを元に実装へ組み込む
- SDK/変換レイヤー（Unity/Unreal/Web 等）は AI を使って生成していく（MVP 2.0 では必須ではないが、出力互換を意識）

---

## 2. MVP 2.0 のスコープ（追加する機能）
### 2.1 デザイナー確認用の「GUI/プレビュー」導入（最小構成）
目的：**デザイナーが視覚的に確認し、修正指示が出せること**

最低限ほしい機能：
- JSON を読み込んで **即プレビュー（SVG/Canvas）**
- コンポーネント選択（クリックで id / role / importance / state 表示）
- “意味”の可視化（例：重要度や役割に応じて枠線色・バッジ表示）
- Before/After や A/B 案の比較表示（2ペイン）
- Export は従来通り（SVG/PNG/PDF）

※ 目標は「編集」ではなく「確認＋指示」。
ピクセルドラッグ編集は MVP 2.0 の必須要件ではない。

### 2.2 「意味ベース微調整」＝AIへの差分修正ループ
AI に UI を丸ごと作り直させるのではなく、**差分修正**を前提にする。

- 例：「tab_bar を強調」「primary_action の主張を1段階上げる」
- UI 定義（JSON/YAML）に対し、AI が差分パッチを生成
- ツール側でパッチ適用→再レンダリング→比較

要件：
- 入力：元 JSON + デザイナーの修正指示（自然言語 or 選択UI）
- 出力：JSON Patch 形式 or “差分 JSON”
- 安全：変更範囲を限定する（対象 component_id のみ等）

### 2.3 UI テンプレートライブラリのファイル化（AI思考用）
「使う使わないは別として」AI が参照できるテンプレ群をリポジトリ管理する。

ディレクトリ案：
- `ui-templates/_catalog/index.yaml`（全テンプレ目録）
- `ui-templates/_catalog/tags.yaml`（固定語彙：タグ辞書）
- `ui-templates/patterns/**.yaml`（意味中心テンプレ）
- `ui-templates/styles/**.yaml`（世界観/配色/装飾ルール）
- `ui-templates/components/**.yaml`（実体部品・再利用単位）

重要：
- テンプレ本文を全部プロンプトに入れない（トークン破綻する）
- **index.yaml で検索→必要なテンプレだけ読み込み**（RAG的運用）
- タグ語彙（tags.yaml）は “憲法”。勝手に増殖させない。

### 2.4 後付けタグ付け＆index生成（テンプレ大量化に備える）
テンプレを先に作ってから、タグと index を後付けで紐付け可能にする。

推奨フロー：
1) テンプレ作成（最低限 `id`, `intent`, `when/avoid`, `constraints` を含める）
2) AI で分類（tags.yaml の語彙へマッピング、同義語を作らせない）
3) `index.yaml` を自動生成
4) 人間がレビュー

---

## 3. データモデル（MVP 2.0 で必須な追加フィールド）
既存 JSON スキーマを前提に、以下のメタ情報を追加（もしくは互換スキーマで保持）：

- `id`: component id（必須）
- `role`: UI役割（action/navigation/container/data_display/feedback 等）
- `importance`: primary/secondary/info など（主導線可視化に使う）
- `state`: default/hover/pressed/disabled/selected 等
- `constraints`: overlap禁止、min_tap、safe_area 等
- `layout_ref`: grid/slot/flow など座標ではない参照（可能なら）

※ AI に絶対座標を直接決めさせない。
レイアウトは grid/slot/flow を基本とし、衝突を減らす。

---

## 4. 非目標（MVP 2.0 ではやらない）
- Figma/Photoshop 代替のフル編集
- ピクセル単位のドラッグレイアウト編集（将来候補）
- エンジン実装 SDK の完全自動生成（別フェーズ）
- 複雑なアニメーションタイムライン GUI（別フェーズ）
- すべてのUI画面をAIがゼロから正解提案（現状AIでは困難）

---

## 5. 成功条件（Acceptance Criteria）
MVP 2.0 完了の判定基準：
1) デザイナーが JSON を読み込み、GUIでプレビュー確認できる
2) コンポーネントを選択してメタ情報（role/importance/state）が見える
3) 修正指示（強調/弱める/変更）を入力できる
4) AI が差分パッチを生成し、適用後のプレビューを比較できる
5) SVG/PNG/PDF を安定出力できる（既存機能維持）
6) テンプレ目録（index.yaml）と固定語彙（tags.yaml）が管理される

---

## 6. 実装優先順位（おすすめ）
1) GUIプレビュー（表示・選択・比較）
2) 重要度/役割の可視化（デザイナー判断軸）
3) 差分修正ループ（AI patch → apply → rerender）
4) テンプレライブラリ（index/tags + 最小セット）
5) 後付け分類（AIでindex自動生成）

---

## 7. 追加メモ（設計思想）
- 本ツールは **橋渡し層**：意味・構造・意図を固定する
- AIは「ゼロから配置」ではなく「テンプレ選択・改善・差分修正」に使う
- GUIは“編集”ではなく“確認と指示”に最適化する
- トークンコストを守る：常時渡すのは index、本文は必要時のみ
